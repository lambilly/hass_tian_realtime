# å¤©èšæ•°è¡Œ-å®æ—¶åŠ¨æ€ Home Assistant é›†æˆ

[![hacs_badge](https://img.shields.io/badge/HACS-Custom-41BDF5.svg)](https://github.com/hacs/integration)

è¿™æ˜¯ä¸€ä¸ªç”¨äº Home Assistant çš„è‡ªå®šä¹‰é›†æˆï¼Œé€šè¿‡å¤©èšæ•°è¡Œ API è·å–å®æ—¶æ•°æ®ï¼ŒåŒ…æ‹¬å¤´æ¡æ–°é—»ã€æ²¹ä»·ã€æ±‡ç‡å’Œç©ºæ°”è´¨é‡ä¿¡æ¯ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ“° **å¤´æ¡æ–°é—»** - å®æ—¶çƒ­ç‚¹æ–°é—»ï¼Œæ”¯æŒè‡ªåŠ¨æ»šåŠ¨æ˜¾ç¤º
- â›½ **ä»Šæ—¥æ²¹ä»·** - å„çœå¸‚æœ€æ–°æ²¹ä»·ä¿¡æ¯
- ğŸ’µ **ç¾å…ƒæ±‡ç‡** - å®æ—¶ç¾å…ƒå…‘äººæ°‘å¸æ±‡ç‡
- â›… **ç©ºæ°”è´¨é‡** - æŒ‡å®šåŸå¸‚çš„ç©ºæ°”è´¨é‡æŒ‡æ•°
- ğŸ”„ **æ»šåŠ¨å±•ç¤º** - æ‰€æœ‰ä¿¡æ¯åœ¨æ»šåŠ¨å®ä½“ä¸­å¾ªç¯æ˜¾ç¤º

## å®‰è£…æ–¹å¼

### æ–¹æ³•ä¸€ï¼šé€šè¿‡ HACS å®‰è£…ï¼ˆæ¨èï¼‰

1. ç¡®ä¿å·²å®‰è£… [HACS](https://hacs.xyz/)
2. åœ¨ HACS ä¸­ç‚¹å‡»ã€Œé›†æˆã€
3. ç‚¹å‡»å³ä¸Šè§’ä¸‰ä¸ªç‚¹ï¼Œé€‰æ‹©ã€Œè‡ªå®šä¹‰ä»“åº“ã€
4. æ·»åŠ ä»“åº“åœ°å€ï¼š`https://github.com/lambilly/hass_tian_realtime`
5. é€‰æ‹©åˆ†ç±»ä¸ºã€Œé›†æˆã€
6. æœç´¢ã€Œå¤©èšæ•°è¡Œ-å®æ—¶åŠ¨æ€ã€å¹¶å®‰è£…
7. é‡å¯ Home Assistant

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å®‰è£…

1. ä¸‹è½½æœ¬é›†æˆæ–‡ä»¶
2. å°† `custom_components/tian_realtime` æ–‡ä»¶å¤¹å¤åˆ¶åˆ°æ‚¨çš„ Home Assistant é…ç½®ç›®å½•ä¸­çš„ `custom_components` æ–‡ä»¶å¤¹
3. é‡å¯ Home Assistant

## é…ç½®

### é€šè¿‡ç•Œé¢é…ç½®

1. è¿›å…¥ Home Assistantã€Œé…ç½®ã€->ã€Œè®¾å¤‡ä¸æœåŠ¡ã€
2. ç‚¹å‡»ã€Œæ·»åŠ é›†æˆã€
3. æœç´¢ã€Œå¤©èšæ•°è¡Œ-å®æ—¶åŠ¨æ€ã€
4. æŒ‰ç…§æç¤ºå¡«å†™ä»¥ä¸‹ä¿¡æ¯ï¼š
   - **API å¯†é’¥**ï¼šä»å¤©èšæ•°è¡Œå®˜ç½‘ç”³è¯·
   - **æ²¹ä»·çœä»½**ï¼šé€‰æ‹©æ‚¨æ‰€åœ¨çš„çœä»½
   - **ç©ºæ°”è´¨é‡åŸå¸‚**ï¼šè¾“å…¥æ‚¨æ‰€åœ¨çš„åŸå¸‚
   - **æ•°æ®æ›´æ–°é—´éš”**ï¼š60-43200åˆ†é’Ÿï¼ˆé»˜è®¤1440åˆ†é’Ÿï¼‰
   - **å¤´æ¡æ»šåŠ¨é—´éš”**ï¼š5-300ç§’ï¼ˆé»˜è®¤15ç§’ï¼‰

### å¤©è¡Œæ•°æ® API ç”³è¯·

1. è®¿é—® [å¤©è¡Œæ•°æ®å®˜ç½‘](https://www.tianapi.com/)
2. æ³¨å†Œè´¦å·å¹¶ç™»å½•
3. åœ¨æ§åˆ¶å°ç”³è¯· API å¯†é’¥
4. ç¡®ä¿å·²å¼€é€šä»¥ä¸‹æ¥å£ï¼š
   - å¤´æ¡çƒ­ç‚¹
   - æ²¹ä»·æŸ¥è¯¢
   - å¤–æ±‡æ±‡ç‡
   - ç©ºæ°”è´¨é‡

## ç”Ÿæˆçš„å®ä½“

é›†æˆå°†åˆ›å»ºä»¥ä¸‹ä¼ æ„Ÿå™¨å®ä½“ï¼š

| å®ä½“åç§° | å®ä½“ID | æè¿° | å›¾æ ‡ |
|---------|--------|------|------|
| å¤´æ¡æ–°é—» | `sensor.toutiao_xin_wen` | çƒ­ç‚¹æ–°é—»ä¿¡æ¯ | `mdi:newspaper-variant-multiple` |
| ä»Šæ—¥æ²¹ä»· | `sensor.jin_ri_you_jia` | æŒ‡å®šçœä»½æ²¹ä»· | `mdi:gas-station` |
| ç¾å…ƒæ±‡ç‡ | `sensor.mei_yuan_hui_lv` | ç¾å…ƒå…‘äººæ°‘å¸æ±‡ç‡ | `mdi:currency-usd` |
| ç©ºæ°”è´¨é‡ | `sensor.kong_qi_zhi_liang` | æŒ‡å®šåŸå¸‚ç©ºæ°”è´¨é‡ | `mdi:air-filter` |
| æ»šåŠ¨å†…å®¹ | `sensor.gun_dong_nei_rong` | æ‰€æœ‰ä¿¡æ¯çš„æ»šåŠ¨å±•ç¤º | `mdi:chart-box-outline` |

## è®¾å¤‡ä¿¡æ¯

æ‰€æœ‰å®ä½“éƒ½å½’å±äºåä¸ºã€Œå®æ—¶åŠ¨æ€ã€çš„è®¾å¤‡ï¼Œæ–¹ä¾¿ç»Ÿä¸€ç®¡ç†ã€‚

## å±æ€§è¯´æ˜

### æ»šåŠ¨å†…å®¹å®ä½“å±æ€§

- `hot_detail` - å½“å‰æ˜¾ç¤ºçš„å¤´æ¡æ–°é—»
- `oil_detail` - æ²¹ä»·ä¿¡æ¯
- `rate_detail` - æ±‡ç‡ä¿¡æ¯  
- `air_detail` - ç©ºæ°”è´¨é‡ä¿¡æ¯
- `hot_index` - å½“å‰å¤´æ¡æ–°é—»çš„åºå·

### å¤´æ¡æ–°é—»å®ä½“å±æ€§

- `detail` - å½“å‰æ˜¾ç¤ºçš„å¤´æ¡å†…å®¹
- `hot_data` - æ‰€æœ‰å¤´æ¡æ–°é—»çš„å­—å…¸ï¼ˆ1-50æ¡ï¼‰
- `hot_index` - å½“å‰æ˜¾ç¤ºçš„æ–°é—»åºå·

## è‡ªåŠ¨åŒ–ç¤ºä¾‹

### å½“ç©ºæ°”è´¨é‡å˜å·®æ—¶å‘é€é€šçŸ¥

```yaml
automation:
  - alias: "ç©ºæ°”è´¨é‡è­¦å‘Š"
    trigger:
      platform: state
      entity_id: sensor.kong_qi_zhi_liang
    condition:
      condition: template
      value_template: >
        {{ state_attr('sensor.kong_qi_zhi_liang', 'detail') | regex_search('AQI:(\\d+)', '\\1') | int > 100 }}
    action:
      service: notify.mobile_app
      data:
        message: "ç©ºæ°”è´¨é‡å˜å·®ï¼š{{ states('sensor.kong_qi_zhi_liang') }}"
